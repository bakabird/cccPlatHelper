"use strict";var t="[UMENG] -- ",e=function(){var e=null,n=!1;function i(){this.setDebug=function(t){n=t};this.d=function(){if(n)try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.debug.apply(console,arguments)}catch(t){}};this.i=function(){try{if(n)try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.info.apply(console,arguments)}catch(t){}}catch(t){}};this.e=function(){if(n)try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.error.apply(console,arguments)}catch(t){}};this.w=function(){if(n)try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.warn.apply(console,arguments)}catch(t){}};this.v=function(){if(n)try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.log.apply(console,arguments)}catch(t){}};this.t=function(){if(n)try{console.table.apply(console,arguments)}catch(t){}};this.tip=function(){try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.log.apply(console,arguments)}catch(t){}};this.tip_w=function(t){try{console.log("%c [UMENG] -- "+t,"background:red; padding: 4px; padding-right: 8px; border-radius: 4px; color: #fff;")}catch(t){}};this.err=function(){try{"string"==typeof arguments[0]&&(arguments[0]=t+arguments[0]);console.error.apply(console,arguments)}catch(t){}};this.repeat=function(t){for(var e=t;e.length<86;)e+=t;return e}}return function(){null===e&&(e=new i);return e}}(),n=function(){var t=null;function e(){var t={};this.useOpenid=function(){return!!t.useOpenid};this.useSwanid=function(){return!!t.useSwanid};this.autoGetOpenid=function(){return!!t.autoGetOpenid};this.appKey=function(){return t.appKey};this.uploadUserInfo=function(){return t.uploadUserInfo};this.enableVerify=function(){return t.enableVerify};this.set=function(e){t=e};this.get=function(){return t};this.setItem=function(e,n){t[e]=n};this.getItem=function(e){return t[e]}}return function(){t||(t=new e);return t}}();function i(){}i.prototype={on:function(t,e,n){var i=this.e||(this.e={});(i[t]||(i[t]=[])).push({fn:e,ctx:n});return this},once:function(t,e,n){var i=this;function r(){i.off(t,r);e.apply(n,arguments)}r._=e;return this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,s=i.length;o<s;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);r.length?n[t]=r:delete n[t];return this}};var r=new i;r.messageType={CONFIG_LOADED:0,UMA_LIB_INITED:1};var o=function(t,e){o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return o(t,e)};function s(t,e){o(t,e);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=new(function(t){s(e,t);function e(){return null!==t&&t.apply(this,arguments)||this}e.prototype.getSdkType=function(){return"ttgamemp"};return e}(function(){function t(){}t.prototype.setStorage=function(t,n,i){tt.setStorage({key:t,data:n,success:function(t){"function"==typeof i&&i(!0)},fail:function(n){e().w(t+": "+n.errMsg);"function"==typeof i&&i(!1)}})};t.prototype.getStorage=function(t,n){tt.getStorage({key:t,success:function(t){"function"==typeof n&&n(t.data)},fail:function(i){e().w(t+": "+i.errMsg);"function"==typeof n&&n()}})};t.prototype.removeStorage=function(t,e){tt.removeStorage({key:t,success:function(){"function"==typeof e&&e(!0)},fail:function(){"function"==typeof e&&e(!1)}})};t.prototype.getSystemInfo=function(t){tt.getSystemInfo({success:function(e){e.safeArea=e.safeArea||{};var n={model:e.model,brand:e.brand,pixelRatio:e.pixelRatio,screenWidth:e.screenWidth,screenHeight:e.screenHeight,fontSizeSetting:e.fontSizeSetting,platform:e.platform,platformVersion:e.version,platformSDKVersion:e.SDKVersion,language:e.language,deviceName:e.model,safeArea:{width:e.safeArea.width,height:e.safeArea.height,top:e.safeArea.top,left:e.safeArea.left,bottom:e.safeArea.bottom,right:e.safeArea.right},statusBarHeight:e.statusBarHeight,host:e.appName},i=e.system.split(" ");if(Array.isArray(i)){n.OS=i[0];n.OSVersion=i[1]}var r=Math.round(e.screenWidth*e.pixelRatio),o=Math.round(e.screenHeight*e.pixelRatio);n.resolution=r>o?r+"*"+o:o+"*"+r;"function"==typeof t&&t(n)},fail:function(){"function"==typeof t&&t()}})};t.prototype.getDeviceInfo=function(t){"function"==typeof t&&t()};t.prototype.checkNetworkAvailable=function(t){tt.getNetworkType({success:function(e){"function"==typeof t&&t(e&&"none"!==e.networkType)},fail:function(){"function"==typeof t&&t()}})};t.prototype.getNetworkInfo=function(t){tt.getNetworkType({success:function(e){"function"==typeof t&&t(e)},fail:function(){"function"==typeof t&&t()}})};t.prototype.onNetworkStatusChange=function(t){tt.onNetworkStatusChange((function(e){"function"==typeof t&&t("none"!==e.networkType)}))};t.prototype.request=function(t){var e=(t=t||{}).success,n=t.fail,i=!1,r=null;t.success=function(t){if(!i){r&&clearTimeout(r);"function"==typeof e&&e(t)}};t.fail=function(){if(!i){r&&clearTimeout(r);"function"==typeof n&&n()}};tt.request(t);r=setTimeout((function(){r&&clearTimeout(r);i=!0;"function"==typeof n&&n(i)}),t.timeout||5e3)};t.prototype.getDeviceId=function(t){t("")};t.prototype.getAdvertisingId=function(t){"function"==typeof t&&t("")};t.prototype.getSdkType=function(){return"ttmp"};t.prototype.getPlatform=function(){return"tt"};t.prototype.getUserInfo=function(t){var n={fail:function(){t&&t()},success:function(e){try{var n=e.userInfo;n&&t&&t({avatar:n.avatarUrl,nickName:n.nickName,gender:n.gender,country:n.country,province:n.province,city:n.city,language:n.language})}catch(e){t&&t()}}};try{tt.getSetting({success:function(t){t.authSetting["scope.userInfo"]&&tt.getUserInfo(n)},fail:function(){t&&t()}})}catch(t){e.e("getUserInfo error",t)}};t.prototype.getAppInfoSync=function(){return{}};t.prototype.onShareAppMessage=function(t){tt.onShareAppMessage(t)};t.prototype.shareAppMessage=function(t){tt.shareAppMessage(t)};t.prototype.getLaunchOptionsSync=function(){var t=null;if(t)return t;if(!tt.getLaunchOptionsSync)return{};try{t=tt.getLaunchOptionsSync()}catch(e){t=null}return t||{}};return t}())),u={SESSION_INTERVAL:3e4,LOG_URL:"/bytedancem_logs",GET_OPENID_URL:"/uminiprogram_logs/bytedance/getuut",USERINFO_URL:"/uminiprogram_logs/comm/uif",ENDPOINT:"https://umini.shujupie.com",ENDPOINTB:"https://ulogs.umeng.com",DEVICE_INFO_KEY:"device_info",ADVERTISING_ID:"mobile_ad_id",ANDROID_ID:"android_id",CURRENT_SESSION:"current_session",SESSION_PAUSE_TIME:"session_pause_time",EVENT_SEND_DEFAULT_INTERVAL:15e3,EVENT_LAST_SEND_TIME:"last_send_time",MAX_EVENTID_LENGTH:128,MAX_PROPERTY_KEY_LENGTH:256,MAX_PROPERTY_KEYS_COUNT:100,REPORT_POLICY:"report_policy",REPORT_INTERVAL_TIME:"report_interval_time",REPORT_POLICY_START_SEND:"1",REPORT_POLICY_INTERVAL:"6",IMPRINT:"imprint",SEED_VERSION:"1.0.0",IMPL_VERSION:"2.8.0",ALIPAY_AVAILABLE_VERSION:"10.1.52",SHARE_PATH:"um_share_path",SHARES:"shares",REQUESTS:"requests",UUID:"um_uuid",UUID_SUFFIX:"ud",OPENID:"um_od",UNIONID:"um_unid",ALIPAYID:"um_alipayid",USERID:"um_userid",PROVIDER:"um_provider",SWANID:"um_swanid",ANONYMOUSID:"um_anonymousid",LAUNCH_OPTIONS:"LAUNCH_OPTIONS",UM_SSRC:"_um_ssrc",USER_INFO:"user_info",IS_ALIYUN:!1};var c={isNumber:function(t){return!Number.isNaN(parseInt(t,10))},compareVersion:function(t,e){for(var n=String(t).split("."),i=String(e).split("."),r=0;r<Math.max(n.length,i.length);r++){var o=parseInt(n[r]||0,10),s=parseInt(i[r]||0,10);if(o>s)return 1;if(o<s)return-1}return 0},getRandomStr:function(t){for(var e="",n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],i=0;i<Number(t);i++){e+=n[Math.round(Math.random()*(n.length-1))]}return e},clone:function(t){return JSON.parse(JSON.stringify(t))},startsWith:function(t,e){return!(!t||!e||0===e.length||e.length>t.length)&&t.substr(0,e.length)===e},endsWith:function(t,e){return!(!e||0===t.length||e.length>t.length)&&t.substring(t.length-e.length)===e},assign:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},deepEqual:function t(e,n){if(e===n)return!0;if(e&&"object"==typeof e&&n&&"object"==typeof n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(var i in e){if(Object.prototype.hasOwnProperty.call(n,i))return!1;if(!t(e[i],n[i]))return!1}return!0}return!1},trimStart:function(t,e){if(!t)return"";if("string"==typeof e&&e.length){var n=new RegExp("^"+e+"*");t=t.replace(n,"")}else t=t.replace(/^s*/,"");return t},trimEnd:function(t,e){if(!t)return"";var n,i;if("string"==typeof e&&e.length){n=new RegExp(e);i=t.length;for(;n.test(t.charAt(i));)i-=1;return t.slice(0,i+1)}n=/s/;i=t.length-1;for(;n.test(t.charAt(i));)i-=1;return t.slice(0,i+1)},isFunction:function(t){return"function"==typeof t}},f=function(){function t(){this._uuid="";this._userid="";this._provider="";this._idType=""}t.prototype.createUUID=function(){return c.getRandomStr(10)+Date.now()+c.getRandomStr(7)+u.UUID_SUFFIX};t.prototype.initUUID=function(t){var e=this;a.getStorage(u.UUID,(function(n){if(n)e._uuid=n;else{e._uuid=e.createUUID();a.setStorage(u.UUID,e._uuid)}t&&t(n)}))};t.prototype.initUserid=function(){var t=this;a.getStorage(u.USERID,(function(n){if(!t._userid&&n){t._userid=n;e().v("userId is ",n)}}));a.getStorage(u.PROVIDER,(function(n){if(!t._provider&&n){t._provider=n;e().v("provider is ",n)}}))};t.prototype.init=function(t){var e=this;e.initUUID((function(){e.initUserid();e.initID(t)}))};t.prototype.setUserid=function(t,e){if(!this._userid&&t){this._userid=t;this._provider=e;a.setStorage(u.USERID,t);a.setStorage(u.PROVIDER,e)}};t.prototype.removeUserid=function(){this._userid=void 0;this._provider=void 0;a.removeStorageSync(u.USERID);a.removeStorageSync(u.PROVIDER)};t.prototype.getUserId=function(){return this._userid};t.prototype.getProvider=function(){return this._provider};t.prototype.getIdType=function(){return this._idType};t.prototype.getIdTracking=function(){var t={};this._uuid&&(t.uuid=this._uuid);this._userid&&(t.userid=this._userid);return t};return t}();!function(t){s(n,t);function n(){var e=null!==t&&t.apply(this,arguments)||this;e._openid="";e._unionid="";e._useOpenid=!1;return e}n.prototype.initID=function(t){var n=this;n._idType=n._useOpenid?"openid":"uuid";e().v("id type: ",n._idType);a.getStorage(u.UNIONID,(function(t){n._unionid=t}));this._useOpenid?a.getStorage(u.OPENID,(function(e){n._openid=e;t&&t()})):t&&t()};n.prototype.setUseOpenid=function(t){this._useOpenid=t};n.prototype.setOpenid=function(t){if(!this._openid&&t){this._openid=t;a.setStorage(u.OPENID,t)}};n.prototype.setUnionid=function(t){if(!this._unionid&&t){this._unionid=t;a.setStorage(u.UNIONID,t)}};n.prototype.getIdTracking=function(){var e=t.prototype.getIdTracking.call(this);this._openid&&(e.openid=this._openid);this._unionid&&(e.unionid=this._unionid);this._userid&&(e.userid=this._userid);return e};n.prototype.getId=function(){return this._useOpenid?this._openid:this._uuid}}(f);var p,d=function(t){s(n,t);function n(){var e=null!==t&&t.apply(this,arguments)||this;e._unionid="";e._openid="";e._anonymousid="";e._useOpenid=!1;return e}n.prototype.getOpenIdAsync=function(t,n){var i=this;tt.login({force:!1,success:function(r){r?a.request({url:u.ENDPOINT+u.GET_OPENID_URL,method:"GET",data:{key:t,code:r.code||"",anonymous_code:r.anonymousCode||""},success:function(t){e().v("tt request ss ",t,u.ENDPOINT+u.GET_OPENID_URL);if(t&&200===t.statusCode&&t.data&&t.data.data){var r=t.data.data;i.setOpenid(r.oid);i.setAnonymousid(r.nid);return n&&n(!0)}n&&n()},fail:function(t){e().v("tt request failed...",t);n&&n()}}):n&&n()},fail:function(t){e().v("tt login failed...",t);n&&n()}})};n.prototype.initID=function(t){var n=this;n._idType="anonymousid";e().v("id type: ",n._idType);a.getStorage(u.OPENID,(function(t){n._openid=t}));a.getStorage(u.ANONYMOUSID,(function(e){n._anonymousid=e;t&&t()}))};n.prototype.setUseOpenid=function(t){this._useOpenid=t};n.prototype.setOpenid=function(t){if(!this._openid&&t){this._openid=t;a.setStorage(u.OPENID,t)}};n.prototype.setAnonymousid=function(t){if(!this._anonymousid&&t){this._anonymousid=t;a.setStorage(u.ANONYMOUSID,t)}};n.prototype.getIdTracking=function(){var e=t.prototype.getIdTracking.call(this);this._openid&&(e.openid=this._openid);this._userid&&(e.userid=this._userid);this._anonymousid&&(e.anonymousid=this._anonymousid);return e};n.prototype.getId=function(){if(this._anonymousid){this._idType="anonymousid";return this._anonymousid}};return n}(f),l=(p=null,function(){p||(p=new d);return p}),h=function(){var t=null;function e(){var t=!1,e=null,n=[];this.addPageStart=function(n){if(n&&!t){e={ts:Date.now(),path:n,page_name:n};t=!0}};this.addPageEnd=function(i){if(t&&i&&e&&i===e.page_name){var r=Date.now()-e.ts;e.duration=Math.abs(r);n.push(e);e=null;t=!1}};this.get=function(){return n};this.getCurrentPage=function(){return e};this.clear=function(){n.length=0}}return function(){t||(t=new e);return t}}(),g={};var v=function(){var t=null,n=[],i="";function r(){return{add:function(t,r){e().v("share origin: %o",t);var o={title:t&&t.title,path:t&&t.path&&t.path.split("?")[0],_um_sts:Date.now()};o.path&&o.path.length>1&&c.startsWith(o.path,"/")&&(o.path=c.trimStart(o.path,"/"));var s=t.path||"",a=l().getId();if(a){var u=i.split(","),f=(u=u.filter((function(t){return t.length>0}))).indexOf(a);f>=0&&(u=u.slice(0,f));u.length<3&&u.push(a);var p=u.join(",");-1!==s.indexOf("?")?s+="&_um_ssrc="+p:s+="?_um_ssrc="+p;var d=Date.now();s+="&_um_sts="+d;if(r){var h=function(t){var e=[];for(var n in t)"_um_ssrc"!==n&&"_um_sts"!==n&&e.push(n+"="+t[n]);return e.join("&")}(g),v=h?h+"&_um_ssrc="+p+"&_um_sts="+d:"_um_ssrc="+p+"&_um_sts="+d;t.query=t.query?t.query+"&_um_ssrc="+p+"&_um_sts="+d:v}else t.path=s;o._um_ssrc=p;o._um_sts=d}n.push(o);e().v("share: %o",t);return t},setShareSource:function(t){i=t},clear:function(){n.length=0},get:function(){return n}}}return function(){t||(t=new r);return t}}(),_=function(t){if(t)try{return JSON.stringify(t)}catch(t){}return""},y=function(t){if(t)try{return JSON.parse(t)}catch(t){}return null},m=function(){var t=null,e="",i=null,r=!1;function o(){this.load=function(t){if(i){a.removeStorage(e);t()}else{e="um_cache_"+n().appKey();a.getStorage(e,(function(n){i=y(n)||{};r=!0;a.removeStorage(e);t()}))}};this.save=function(){i&&a.setStorage(e,_(i))};this.set=function(t,e){i&&(i[t]=e)};this.get=function(t){return(i||{})[t]};this.remove=function(t){i&&i[t]&&delete i[t]};this.getAll=function(){return i};this.clear=function(){i=null};this.has=function(t){return!!this.get(t)};this.isLoaded=function(){return r}}return function(){t||(t=new o);return t}}(),S=function(){var t,n,i=[],r=[];function o(){if(i.length){var t=m().get("ekvs");if(function(t){var e=0;for(var n in t)Array.isArray(t[n])&&(e+=t[n].length);return e}(t)+i.length<=1e4){t=s(t,i);m().set("ekvs",t)}}}function s(t,e){var i=(t=t||{})[n];Array.isArray(i)&&i.length?t[n]=i.concat(e):t[n]=[].concat(e);return t}return function(){t||(t={addEvent:function(t){if(n){i.unshift(t);if(i.length>1){o();i.length=0}}else{e().w("session id is null: ",n);r.unshift(t)}},setSessionId:function(t){n=t;e().v("setSessionId: ",n);if(Array.isArray(r)&&r.length&&n){for(var i=0;i<r.length;i++)this.addEvent(r[i]);r.length=0}},getEkvs:function(){var t=m().get("ekvs");i&&i.length&&(t=s(t,i));return t},clear:function(){m().remove("ekvs");i.length=0}});return t}}(),I="2g",O="3g",E="4g",A="half_session",N="close_session",T="ekv",k=["access","access_subtype"],D=function(){var t=null;function e(){var t=!1,e={};function i(t){var i=m().get(u.IMPRINT);i&&(e.imprint=i);e.device_type="Phone";e.sdk_version=u.IMPL_VERSION;e.appkey=n().appKey();a.getDeviceInfo((function(t){e.device_info=t||""}));var r=a.getAppInfoSync();e.appid=r.appId;e.app_env=r.appEnv;e.app_version=r.appVersion;a.getSystemInfo((function(n){a.getNetworkInfo((function(i){var r=function(t,e){var n={};(t=t||{}).safeArea=t.safeArea||{};var i=(e=e||{}).networkType;"none"===i&&(i="unknown");var r=t.model||"",o=t.platform||"",s=t.brand||"",u=s.toLowerCase();n.sdk_type=a.getSdkType();n.platform=a.getPlatform();n.platform_sdk_version=t.platformSDKVersion;n.platform_version=t.platformVersion;n.resolution=t.resolution;n.pixel_ratio=t.pixelRatio;n.os=o;n.font_size_setting=t.fontSizeSetting;n.device_model=r;n.device_brand=s;n.device_manufacturer=u;n.device_manuid=r;n.device_name=r;n.os_version=t.OSVersion;n.language=t.language;n.theme=t.theme;n.benchmark_level=t.benchmarkLevel;n.status_bar_height=t.statusBarHeight;n.safe_area_top=t.safeArea.top;n.safe_area_left=t.safeArea.left;n.safe_area_right=t.safeArea.right;n.safe_area_bottom=t.safeArea.bottom;n.safe_area_height=t.safeArea.height;n.safe_area_width=t.safeArea.width;n.storage=t.storage;n.screen_width=t.screenWidth;n.screen_height=t.screenHeight;n.host=t.host;switch(i=i?i.toLowerCase():""){case E:n.access_subtype="LTE";n.access="4G";break;case O:n.access_subtype="CDMA";n.access="3G";break;case I:n.access_subtype="GRPS";n.access="2G";break;default:n.access=i;delete n.access_subtype}return n}(n,i);c.assign(e,r);t&&t()}))}))}return{init:function(){i((function(){t=!0}))},isLoaded:function(){return t},get:function(){return e},getRealtimeFields:function(){var t={};k.forEach((function(n){t[n]=e[n]}));return t},setIdTracking:function(t){this.setItem("id_tracking",t)},setIdType:function(t){this.setItem("id_type",t)},setAppVersion:function(t){this.setItem("app_version",t)},setSuperProperty:function(t){e.sp||(e.sp={});e.sp.isv=t},getSuperProperty:function(){return e&&e.sp?e.sp.isv:""},setItem:function(t,n){e[t]=n},getItem:function(t){return e[t]}}}return{instance:function(){t||(t=e());return t}}}(),b=function(){var t=null,n=null,i=null;function r(){return{resume:function(t){var r=!1;i||(i=m().get(u.CURRENT_SESSION));var o=new Date;n=o.getTime();if(!i||!i.end_time||n-i.end_time>u.SESSION_INTERVAL){r=!0;!function(t){try{var n=(i||{}).options||{},r=c.assign({},function(t){var n={};for(var i in t)0===i.indexOf("_um_")&&(n[i]=t[i]);e().v("query: ",t);e().v("_um_params: ",n);return n}(t.query));r.path=t.path||n.path;"gaode"!==a.getPlatform()&&(r.scene=t.scene?a.getPlatform()+"_"+t.scene:n.scene);var o=t.referrerInfo;o&&(r.referrerAppId=o.appId);e().v("session options: ",r);var s=r[u.UM_SSRC];s&&v().setShareSource(s);var f=Date.now();i={id:c.getRandomStr(10)+f,start_time:f,options:r}}catch(t){e().e("生成新session失败: ",t)}}(t);e().v("开始新的session(%s): ",i.id,i)}else e().v("延续上一次session(%s): %s ",i.id,o.toLocaleTimeString(),i);return r},pause:function(){!function(){if(i){var t=new Date;i.end_time=t.getTime();"number"!=typeof i.duration&&(i.duration=0);i.duration=i.end_time-n;m().set(u.CURRENT_SESSION,i);e().v("退出会话(%s): %s ",i.id,t.toLocaleTimeString(),i)}}()},getCurrentSessionId:function(){return(i||{}).id},getCurrentSession:function(){return i},cloneCurrentSession:function(){return c.clone(i)}}}return function(){t||(t=r());return t}}();function w(t){var e=null;switch(t){case A:e=function(){var t=null,e=b().cloneCurrentSession();e&&(t={header:{st:"1"},analytics:{sessions:[e]}});return t}();break;case N:e=function(){var t=null,e={},n=b().cloneCurrentSession();if(n){var i=h().get(),r=v().get();Array.isArray(i)&&i.length&&(n.pages=c.clone(i));Array.isArray(r)&&r.length&&(n.shares=c.clone(r));h().clear();v().clear();e.sessions=[n]}var o=S().getEkvs();if(o){e.ekvs=c.clone(o);S().clear()}(e.sessions||e.ekvs)&&(t={analytics:e});return t}();break;case T:e=function(){var t=null,e=S().getEkvs();if(e){t={analytics:{ekvs:c.clone(e)}};S().clear()}return t}()}return e}var U={sessions:"sn",ekvs:"e",active_user:"active_user"},R={sdk_type:"sdt",access:"ac",access_subtype:"acs",device_model:"dm",language:"lang",device_type:"dt",device_manufacturer:"dmf",device_name:"dn",platform_version:"pv",id_type:"it",font_size_setting:"fss",os_version:"ov",device_manuid:"did",platform_sdk_version:"psv",device_brand:"db",appkey:"ak",_id:"id",id_tracking:"itr",imprint:"imp",sdk_version:"sv",resolution:"rl",testToken:"ttn",theme:"t5",benchmark_level:"bml",screen_width:"sw",screen_height:"sh",status_bar_height:"sbh",safe_area_top:"sat",safe_area_left:"sal",safe_area_right:"sar",safe_area_bottom:"sab",safe_area_height:"sah",safe_area_width:"saw",pixel_ratio:"pr",storage:"s7",host:"hs"},P={uuid:"ud",unionid:"und",openid:"od",anonymousid:"nd",alipay_id:"ad",device_id:"dd",userid:"puid"};function C(t,e){var n=L(t,e);t&&t.id_tracking&&(n[e.id_tracking||"id_tracking"]=L(t.id_tracking,P));return n}function L(t,e){var n={};for(var i in t)e[i]?n[e[i]]=t[i]:n[i]=t[i];return n}function M(t,e){var n={};if(t)for(var i in t)t[i]&&(n[e[i]]=t[i]);return n}var j="";function V(){return j}var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=function(t){for(var e={},n=0,i=t.length;n<i;n++)e[t.charAt(n)]=n;return e}(G),F=String.fromCharCode,q=function(t){if(t.length<2){return(e=t.charCodeAt(0))<128?t:e<2048?F(192|e>>>6)+F(128|63&e):F(224|e>>>12&15)+F(128|e>>>6&63)+F(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return F(240|e>>>18&7)+F(128|e>>>12&63)+F(128|e>>>6&63)+F(128|63&e)},K=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Y=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[G.charAt(n>>>18),G.charAt(n>>>12&63),e>=2?"=":G.charAt(n>>>6&63),e>=1?"=":G.charAt(63&n)].join("")},H=function(t){return e=function(t){return t.replace(K,q)}(t),e.replace(/[\s\S]{1,3}/g,Y);var e},J=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),B=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return F(55296+(e>>>10))+F(56320+(1023&e));case 3:return F((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return F((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},X=function(t){var e=t.length,n=e%4,i=(e>0?x[t.charAt(0)]<<18:0)|(e>1?x[t.charAt(1)]<<12:0)|(e>2?x[t.charAt(2)]<<6:0)|(e>3?x[t.charAt(3)]:0),r=[F(i>>>16),F(i>>>8&255),F(255&i)];r.length-=[0,0,2,1][n];return r.join("")},W=function(t){return e=function(t){return t.replace(/[\s\S]{1,4}/g,X)}(t),e.replace(J,B);var e},z=function(t,e){return e?H(String(t)).replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"})).replace(/=/g,""):H(String(t))},Q=function(t){return W(String(t).replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))};var Z=new function(){var t="",e=this;this.set=function(e){t=e};this.get=function(){return t};this.getImpObj=function(){return y(Q(t))};this.getItem=function(t){var n=e.getImpObj();return n&&n[t]||""};this.load=function(){t=m().get(u.IMPRINT)};this.save=function(){t&&m().set(u.IMPRINT,t)}};function $(t,n,i,r){D.instance().setIdType(l().getIdType());D.instance().setIdTracking(l().getIdTracking());var o=l().getUserId();o&&t.analytics&&(t.analytics.active_user={puid:o,provider:l().getProvider()});var s=c.clone(D.instance().get());t.header=c.assign(s,t.header,{ts:Date.now(),testToken:V(),traceId:c.getRandomStr(10)+Date.now()+c.getRandomStr(9)});var f=function(t){return{h:C(t.header,R),a:M(t.analytics,U)}}(t),p=_(f),d={url:u.ENDPOINT+u.LOG_URL,method:"POST",data:f,success:function(r){var o=r.code||r.status||r.statusCode;if(200===o||413===o){e().i("数据发送成功: ",t,p);!function(t){if(t){D.instance().setItem(u.IMPRINT,t);Z.set(t);Z.save();e().v("imprint: ",Z.getImpObj());Z.getItem("ttn_invalid")&&(j="")}}((r.data||{}).imprint);"function"==typeof n&&n(r)}else{e().w("数据发送失败: ",p);"function"==typeof i&&i()}},fail:function(t){e().w("超时: ",p);"function"==typeof i&&i()},complete:function(){"function"==typeof r&&r()}};a.request(c.assign(d,{header:{"Msg-Type":a.getSdkType()+"/json","disable-base64":"Y"}}))}function et(t){var e=t,n=[];this.enqueue=function(t){"number"==typeof e&&this.size()>=e&&this.dequeue();n.push(t)};this.dequeue=function(){return n.shift()};this.front=function(){return n[0]};this.isEmpty=function(){return 0===n.length};this.clear=function(){n.length=0};this.size=function(){return n.length};this.items=function(){return n};this.print=function(){console.log(n.toString())}}var nt=function(){var t=null,n=!1,i=[],r=new et(50);function o(t,e,n){if(D.instance().isLoaded()){e=e||{};var i=w(t);if(i){var s=D.instance().getRealtimeFields();i.header=c.assign({},i.header,s);i.noCache=e.noCache;r.enqueue(i)}"function"==typeof n&&n()}else setTimeout((function(){o(t,e,n)}),100)}function s(t){var e=r.front();if(e)$(e,(function(){r.dequeue();s(t)}),(function(){var e=r.dequeue();e&&!e.noCache&&i.push(e);s(t)}));else{!function(){i.forEach((function(t){r.enqueue(t)}));i.length=0}();t()}}function a(t){if(l().getId())if(n)e().i("队列正在发送中");else{n=!0;s((function(){n=!1;"function"==typeof t&&t()}))}else{e().i("获取id标识失败，暂缓发送");"function"==typeof t&&t()}}function f(){this.send=function(t,e,n){t?this.add(t,e,(function(){a(n)})):a(n)};this.add=function(t,e,n){o(t,e,n)};this.load=function(){var t=m().get(u.REQUESTS);t&&t.length&&t.forEach((function(t){r.enqueue(t)}));m().remove(u.REQUESTS)};this.save=function(){m().set(u.REQUESTS,c.clone(r.items()));r.clear()}}return function(){t||(t=new f);return t}}(),it=function(){var t=null,i=null;function r(){this.setUserInfo=function(t){i=t};this.update=function(){t(i)||a.getUserInfo((function(e){t(e)}))};function t(t){if(t&&"object"==typeof t){var i=m().get(u.USER_INFO);i&&c.deepEqual(t,i)||function(t,i){var r=n().appKey(),o=a.getSdkType(),s=l().getId(),c=l().getIdType();if(!(r&&o&&s&&c))return;var f={ak:n().appKey(),sdt:a.getSdkType(),uin:t.nickName,uia:t.avatar||t.avatarUrl,uig:t.gender,uit:t.country,uip:t.province,uic:t.city,uil:t.language,id:l().getId(),it:l().getIdType(),age:t.age,cln:t.constellation},p=JSON.stringify(f);p=z(p);a.request({url:u.ENDPOINT+u.USERINFO_URL,method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:"ui="+p,success:function(n){e().v("用户信息上传成功: ",t);i&&i(n&&n.data&&200===n.data.code)},fail:function(){e().e("用户信息上传失败: ",t);i&&i(!1)}})}(t,(function(e){e&&m().set(u.USER_INFO,t)}));return!0}return!1}}return function(){t||(t=new r);return t}}();function rt(t,e){this.id=t;this.ts=Date.now();var n=typeof e;if("string"===n&&e)this[t]=e;else if("object"===n)for(var i in e)({}).hasOwnProperty.call(e,i)&&(this[i]=e[i])}function ot(){var t=!1,i=!1,r=0;this.init=function(i){e().v("sdk version: "+u.IMPL_VERSION);t?e().v("Lib重复实例化"):m().load((function(){e().v("cache初始化成功: ",m().getAll());!function(){l().setUseOpenid&&l().setUseOpenid(n().useOpenid());l().init((function(){D.instance().init();e().v("Header初始化成功")}))}();t=!0;"function"==typeof i&&i();e().tip("SDK集成成功")}))};this.resume=function(r){if(t&&!i){e().v("showOptions: ",r);var o;i=!0;n().enableVerify()&&r&&r.query&&(o=r.query._ttn,j=o||j);this._resume(r)}};this._resume=function(t){nt().load();var i=b().resume(t),r=b().getCurrentSessionId();S().setSessionId(r);i&&nt().add(A,{},(function(){l().setUseOpenid&&l().setUseOpenid(n().useOpenid());if(n().useOpenid()&&n().autoGetOpenid()&&!l().getId()){e().v("get id async");o(10,3e3)}else{e().v("session auto send");nt().send()}}));function o(t,i){l().getId()||t<=0||l().getOpenIdAsync(n().appKey(),(function(n){if(n){e().v("获取id成功");nt().send()}else{e().v("获取openid失败,启动重试,剩余可用次数",t-1);setTimeout((function(){o(t-1,i)}),i)}}))}};this.pause=function(o){if(t){i=!1;r=0;b().pause();n().uploadUserInfo()&&it().update();nt().send(N,{},(function(){nt().save();m().save();e().v("cache save success");"function"==typeof o&&o()}))}};this.setOpenid=function(t){e().v("setOpenId: %s",t);l().setOpenid(t);nt().send()};this.setUnionid=function(t){e().v("setUnionid: %s",t);l().setUnionid(t)};this.setUserid=function(t,n){e().v("setUserid: %s",t,n);l().setUserid(t,n)};this.removeUserid=function(){e().v("removeUserid");l().removeUserid()};this.setUserInfo=function(t){e().v("setUserInfo: %s",t);it().setUserInfo(t)};this.setAnonymousid=function(t){e().v("setAnonymousId: %s",t);l().setAnonymousid(t);nt().send()};this.setAppVersion=function(t){t&&"string"!=typeof t?e().w("setAppVersion方法只接受字符串类型参数"):D.instance().setAppVersion(t)};this.setAlipayUserid=function(t){if(t&&"string"!=typeof t)e().w("setAlipayUserid方法只接受字符串类型参数");else{e().v("setAlipayUserid: %s",t);l().setAlipayUserid(t)}};this.setDeviceId=function(t){if("string"==typeof t){l().setDeviceId(t);return t}};this.setSuperProperty=function(t){if(t&&"string"!=typeof t)e().w("超级属性只支持字符串类型");else{var n=this;if(D.instance().getSuperProperty()!==t){D.instance().setSuperProperty(t);n.pause((function(){n.resume()}))}}};this.trackEvent=function(n,i){if(t){e().v("event: ",n,i);if(function(t,n){if(!t||"string"!=typeof t){e().e('please check trackEvent id. id should be "string" and not null');return!1}var i=["id","ts","du"],r={};i.forEach((function(t){r[t]=1}));if(r[t]){e().e("eventId不能与以下保留字冲突: "+i.join(","));return!1}if(t.length>u.MAX_EVENTID_LENGTH){e().e("The maximum length of event id shall not exceed "+u.MAX_EVENTID_LENGTH);return!1}if(n&&("object"!=typeof n||Array.isArray(n))&&"string"!=typeof n){e().e("please check trackEvent properties. properties should be string or object(not include Array)");return!1}if("object"==typeof n){var o=0;for(var s in n)if({}.hasOwnProperty.call(n,s)){if(s.length>u.MAX_PROPERTY_KEY_LENGTH){e().e("The maximum length of property key shall not exceed "+u.MAX_PROPERTY_KEY_LENGTH);return!1}if(o>=u.MAX_PROPERTY_KEYS_COUNT){e().e("The maximum count of properties shall not exceed "+u.MAX_PROPERTY_KEYS_COUNT);return!1}if(r[s]){e().e("属性中的key不能与以下保留字冲突: "+i.join(","));return!1}o+=1}}return!0}(n,i)){var o=new rt(n,i);S().addEvent(o);var s=!!V(),a=s?0:u.EVENT_SEND_DEFAULT_INTERVAL,c=Date.now();if(function(t,e){return"number"!=typeof r||"number"!=typeof e||r<=0||t-r>e}(c,a)){r=c;nt().send(T,{noCache:s},(function(){}))}}}};this.trackShare=function(n){if(t)try{if(a.getSdkType().indexOf("game")>-1){n=v().add(n,!0);e().v("shareQuery: ",n)}else{n=v().add(n,!1);e().v("sharePath: ",n.path)}}catch(t){e().v("shareAppMessage: ",t)}return n};this.trackPageStart=function(e){t&&h().addPageStart(e)};this.trackPageEnd=function(e){t&&h().addPageEnd(e)};this.onShareAppMessage=function(t){var e=this;a.onShareAppMessage((function(){return e.trackShare(t())}))};this.shareAppMessage=function(t){this.trackShare(t);a.shareAppMessage(t)}}var st=[];function at(){}at.prototype={createMethod:function(t,n,i){try{t[n]=i&&i[n]?function(){return i[n].apply(i,arguments)}:function(){st.push([n,[].slice.call(arguments)])}}catch(t){e().v("create method errror: ",t)}},installApi:function(t,n){try{var i,r,o="resume,pause,trackEvent,trackPageStart,trackPageEnd,trackShare,setUserid,setOpenid,setAnonymousid,onShareAppMessage,shareAppMessage".split(",");for(i=0,r=o.length;i<r;i++)this.createMethod(t,o[i],n);if(n)for(i=0,r=st.length;i<r;i++){var s=st[i];try{n[s[0]].apply(n,s[1])}catch(t){e().v("impl[v[0]].apply error: ",s[0],t)}}}catch(t){e().v("install api errror: ",t)}}};var ut=[u.ENDPOINT,u.ENDPOINTB];function ct(t,n){var i,r;0===t||1===t&&n?i=u.ENDPOINT:2===t&&n?i=u.ENDPOINTB:n&&(i=ut[t]);if(t>=ut.length||n){n&&(r=i,u.ENDPOINT=r);n&&e().v("命中可用服务",i);!n&&e().tip_w("未命中可用服务");return!1}a.request({url:u.ENDPOINT+"/uminiprogram_logs/ckdh",success:function(e){200===(e.code||e.status||e.statusCode)&&e.data&&200===e.data.code?ct(t+1,!0):ct(t+1,!1)},fail:function(){ct(t+1,!1)}})}var ft={init:function(t){u.ENDPOINTB&&setTimeout((function(){ct(0,!1)}),t)}},pt=new at,dt={_inited:!1,_log:e(),preinit:function(t){if(t&&"object"==typeof t)for(var e in t)u[e]=t[e];return u},use:function(t,e){t&&c.isFunction(t.install)?t.install(dt,e):c.isFunction(t)&&t(dt,e);return dt},messager:r,init:function(t){if(this._inited)e().v("已经实例过，请避免重复初始化");else if(t)if(t.appKey){"boolean"!=typeof t.useOpenid&&(t.useOpenid=!0);n().set(t);e().setDebug(t.debug);this._inited=!0;var i=this;r.emit(r.messageType.CONFIG_LOADED,t);try{var o=new ot;e().v("成功创建Lib对象");0;o.init((function(){e().v("Lib对象初始化成功");pt.installApi(i,o);e().v("安装Lib接口成功");r.emit(r.messageType.UMA_LIB_INITED,t)}));ft.init(3e3)}catch(t){e().w("创建Lib对象异常: "+t)}}else e().err("请确保传入正确的appkey");else e().err("请正确设置相关信息！")}};try{pt.installApi(dt,null)}catch(t){e().w("uma赋值异常: ",t)}var lt="https://ucc.umeng.com/v1/mini/fetch",ht="https://pslog.umeng.com/mini_ablog",gt="2.8.0",vt="none",_t={},yt=Array.isArray;_t.isArray=yt||function(t){return"[object Array]"===toString.call(t)};_t.isObject=function(t){return t===Object(t)&&!_t.isArray(t)};_t.isEmptyObject=function(t){if(_t.isObject(t)){for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0}return!1};_t.isUndefined=function(t){return void 0===t};_t.isString=function(t){return"[object String]"===toString.call(t)};_t.isDate=function(t){return"[object Date]"===toString.call(t)};_t.isNumber=function(t){return"[object Number]"===toString.call(t)};_t.each=function(t,e,n){if(null!=t){var i={},r=Array.prototype.forEach;if(r&&t.forEach===r)t.forEach(e,n);else if(t.length===+t.length){for(var o=0,s=t.length;o<s;o++)if(o in t&&e.call(n,t[o],o,t)===i)return}else for(var a in t)if(hasOwnProperty.call(t,a)&&e.call(n,t[a],a,t)===i)return}};_t.buildQuery=function(t,e){var n,i,r=[];void 0===e&&(e="&");_t.each(t,(function(t,e){n=encodeURIComponent(t.toString());i=encodeURIComponent(e);r[r.length]=i+"="+n}));return r.join(e)};_t.JSONDecode=function(t){if(t){try{return JSON.parse(t)}catch(t){console.error("JSONDecode error",t)}return null}};_t.JSONEncode=function(t){try{return JSON.stringify(t)}catch(t){console.error("JSONEncode error",t)}};var mt=Object.create(null);function St(t){e().v("开始构建 fetch body");a.getSystemInfo((function(e){a.getNetworkInfo((function(i){var r=(i=i||{}).networkType;r=r===vt?"unknown":r.toUpperCase();mt.access=r;!function(t,e){var i=t.brand||"";mt.deviceType="Phone";mt.sdkVersion=gt;mt.appkey=n().appKey();mt.sdkType=a.getSdkType();mt.umid=l().getId();if(t){mt.language=t.language||"";mt.os=t.OS;mt.osVersion=t.OSVersion;mt.deviceName=t.deviceName;mt.platformVersion=t.platformVersion;mt.platformSdkVersion=t.platformSDKVersion;mt.deviceBrand=i;var r=t.resolution.split("*");if(_t.isArray(r)){mt.resolutionHeight=Number(r[0]);mt.resolutionWidth=Number(r[1])}}!function(t){if(t){mt.installTime=t.install_datetime&&Date.parse(t.install_datetime);mt.scene=t.install_scene;mt.channel=t.install_channel;mt.campaign=t.install_campaign}}(Z.getImpObj());e&&e(mt)}(e,t)}))}))}var It=Object.create(null),Ot=null,Et=!1,At={minFetchIntervalSeconds:43200};function Nt(t){t&&_t.each(t,(function(t){It[t.k]=t}))}function Tt(){var t=this;this.STORAGE_NAME=null;r.once(r.messageType.CONFIG_LOADED,(function(n){e().v("云配初始化开始...");t.init(n)}))}Tt.prototype={setDefaultValues:function(t){Et&&_t.isObject(t)&&_t.each(t,(function(t,e){It[e]&&It[e].v||(It[e]={v:t})}))},getValue:function(t){e().v("从配置项中读取 value, 当前配置为: ",It);e().v("待读取的 key : ",t);try{if(!Et)return;var i=It[t]||{};e().v("读取相应配置ing..., 结果为: ",i);if(_t.isNumber(i.e)&&_t.isNumber(i.g)){e().v("读取到相应配置, 开始数据上报...");!function(t){var i={appkey:n().appKey(),sdkType:a.getSdkType(),expId:t&&t.e,groupId:t&&t.g,clientTs:Date.now(),key:t&&t.k,value:t&&t.v,umid:l().getId()};try{a.request({url:ht,method:"POST",data:[i],success:function(t){t&&200===t.statusCode?e().v("上传数据成功",i):e().w("ablog 请求成功, 返回结果异常 ",t)},fail:function(t){e().w("ablog 请求数据错误 ",i,t)}})}catch(t){e().w("urequest 调用错误",t)}}(i)}return i.v}catch(n){e().w("getValue error, key: ",t)}},active:function(t){try{if(!Et)return;var n,i;t&&t.params&&(n=t.params);t&&t.callback&&(i=t.callback);e().v("激活配置项: ",n);if(n){e().v("本地已缓存的配置项: ",It);Nt(n);e().v("合并后的配置项: ",It);i&&i(It);e().v("active 结束")}else{e().v("配置项为空!! 读取本地配置...");a.getStorage(this.STORAGE_NAME,(function(t){if(t){Nt((t=_t.JSONDecode(t)||{}).params);e().v("当前本地配置项为: ",It);i&&i(It);e().v("active 结束")}else e().v("当前本地配置项为空, 退出激活")}))}}catch(t){e().w("SDK active 错误",t)}},init:function(t){if(t.appKey){Ot=t.appKey;this.STORAGE_NAME="um_remote_config_{{"+Ot+"}}"}if(Ot)if(Et)e().w("SDK 已经初始化, 请避免重复初始化");else{Et=!0;this.setOptions(t);this.active()}else e().err("请检查您的小程序 appKey, appKey 不能为空")},setOptions:function(t){if(_t.isObject(t)){var e=t.minFetchIntervalSeconds;_t.isNumber(e)&&(At.minFetchIntervalSeconds=Math.max(e,5))}},fetch:function(t){if(Et&&this.STORAGE_NAME){var n,i;t&&t.active&&(n=t.active);t&&t.callback&&(i=t.callback);var r=this;a.getStorage(this.STORAGE_NAME,(function(t){e().v("开始读缓存 data is ",t);if((t=_t.JSONDecode(t)||{}).params&&t.ts&&Date.now()-t.ts<1e3*At.minFetchIntervalSeconds){e().v("缓存数据存在, 并且本次触发时间距离上次fetch触发时间未超过 fetch 时间间隔, 无需 fetch");i&&i(t.params)}else St((function(t){e().v("缓存数据不存在, 构建 fetch body :",t);try{a.request({url:lt,method:"POST",data:t,success:function(t){if(t&&200===t.statusCode&&t.data&&t.data.cc){e().v("fetch 请求成功, 响应数据: ",t.data);var o=Object.create(null);_t.each(t.data.cc,(function(t){o[t.k]=t}));var s={ts:Date.now(),params:o};e().v("开始缓存 fetch 请求的云配置结果...");a.setStorage(r.STORAGE_NAME,_t.JSONEncode(s),(function(t){e().v("缓存云配置成功, 缓存数据为: ",s);e().v("缓存云配置成功, 成功消息为: ",t);e().v("云配拉取数据是否自动激活: ",n);if(t&&n){e().v("激活云配置...");r.active({params:o,callback:i})}}))}else{e().w("fetch 请求成功,返回结果异常 ",t.data);i&&i()}},fail:function(n){e().w("fetch请求数据错误 ",t,n);i&&i()}})}catch(t){e().w("urequest调用错误",t)}}))}))}}};var kt={install:function(t,e){t.rc||(t.rc=new Tt);t.messager.once(t.messager.messageType.CONFIG_LOADED,(function(){t._log.v("plugin rc installed")}));return t.rc}},Dt="_um",bt="revenue",wt="stage",Ut="level",Rt="running",Pt="end",Ct="init",Lt="set",Mt=[Dt,wt,"start"].join(".");function jt(t){var e={};for(var n in t){var i=t[n];if("object"==typeof i)for(var r in i)e[n+"."+r]=i[r];else e[n]=i}return e}var Vt={install:function(t,e){t.revenue=function(e){t.trackEvent([Dt,bt,e.group].join("."),jt(e))};var n=0;t.stage={onStart:function(e){n=Date.now();t.trackEvent(Mt,jt(e))},onEnd:function(e){"number"!=typeof e._um_sdu&&(e._um_sdu=0!==n?Date.now()-n:0);t.trackEvent([Dt,wt,Pt,e.event].join("."),jt(e))},onRunning:function(e){t.trackEvent([Dt,wt,Rt,e.event].join("."),jt(e))}};t.level={onInitLevel:function(e){t.trackEvent([Dt,Ut,Ct].join("."),jt(e))},onSetLevel:function(e){t.trackEvent([Dt,Ut,Lt].join("."),jt(e))}};t.messager.once(t.messager.messageType.CONFIG_LOADED,(function(){t._log.v("plugin game-ext installed")}));return t}};tt.onShow((function(t){e().v("game onShow: ",t);n=t.query,g=n;var n;dt.resume(t,!0)}));tt.onHide((function(){e().v("game onHide");dt.pause()}));var Gt=dt.init;dt.init=function(t){if(t&&t.useOpenid){e().tip_w(e().repeat("!"));e().tip_w("您选择了使用openid进行统计，请确保使用setOpenid回传openid或通过设置autoGetOpenid为true，并在友盟后台设置secret由友盟帮您获取");e().tip_w(e().repeat("!"))}Gt.call(dt,t)};dt.use(kt);dt.use(Vt);tt.uma=dt;module.exports=dt;
